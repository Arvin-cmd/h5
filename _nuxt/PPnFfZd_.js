import{a as se,u as oe,_ as ie,s as le}from"./a6TzHPhG.js";import{_ as re,a as ue}from"./Dd2HMfjq.js";import{c as b,r as v,C as I,D as de,v as pe,x as ce,ay as ye,m as F,q as U,n as a,y as e,aw as W,p as i,J as P,ax as L,I as G,o as y}from"./D_vluf58.js";import{p as q,f as J,c as X,a as K,b as C,s as h,d as me}from"./kVIP1FPO.js";import{g as fe,u as be,a as ve,b as Q}from"./BLi2ATmW.js";import{u as Y}from"./BLgQIrXo.js";import{a as we}from"./B25L3hkw.js";import{_ as xe}from"./DlAUqK2U.js";import"./C0_2x2wr.js";const _e=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AccessControlBadConfirmation",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"neededRole",type:"bytes32"}],name:"AccessControlUnauthorizedAccount",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Swap",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"adminWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_usdt",type:"address"},{internalType:"address",name:"_ubToken",type:"address"},{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"callerConfirmation",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"swap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"swapFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ubToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"usdt",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"}],Fe=()=>{const w=se(),t=fe("EXCHANGE"),{writeContractAsync:x}=be({}),{connect:u}=ve(),n=b(()=>({address:t.value,abi:_e})),r=v(0n);async function m(){return r.value=await de(w,{...n.value,functionName:"swapFee"}),r.value}async function l(p){await u();const c=await x({...n.value,functionName:"setSwapFee",args:[p]});await I(w,{hash:c})}async function k(p,c){const _=await x({...n.value,functionName:"swap",args:[p,c]});await I(w,{hash:_})}async function f(p){await u();const c=await x({...n.value,functionName:"adminWithdraw",args:[p]});await I(w,{hash:c})}return{address:t,fee:r,swapFee:m,setSwapFee:l,swap:k,adminWithdraw:f}},he={class:"flex flex-col h-screen"},ke={class:"mx-4 mt-10 border border-[#FFFFFF33] p-5 rounded-xl bg-white/10 backdrop-blur-sm border-bg"},Te={class:"relative"},ge={class:"mb-4"},Ie={class:"flex gap-4 pb-4"},Ue={class:"text-[#D1D1D1] text-xs mb-2"},Ce={class:"bg-[#FFFFFF1A] rounded-lg p-3"},Me={class:"flex justify-between items-center mb-2"},Ae={class:"flex items-center"},Ne=["src"],De={class:"text-white font-medium text-xs"},Re={class:"text-right"},Be={class:"text-[#FFFFFF80] text-xs"},Se={class:"flex justify-between items-center"},He={class:"mb-4"},Ee={class:"text-[#D1D1D1] text-xs mb-2"},$e={class:"bg-[#FFFFFF1A] rounded-lg p-3"},ze={class:"flex justify-between items-center mb-2"},je={class:"flex items-center"},Oe=["src"],Ve={class:"text-white font-medium text-xs"},We={class:"text-right"},Pe={class:"text-[#FFFFFF80] text-xs"},Le={class:"flex justify-between items-center"},Ge=["value"],qe={class:"flex justify-center mt-4"},Je=["disabled"],Xe={key:1},Ke=["disabled"],Qe={key:1},Ye={class:"text-center mt-3 text-[#FFFFFF80] text-xs"},Ze=pe({__name:"index",setup(w){const{t}=ce();we({title:"UU"+t("竞拍")+" - "+t("快捷代币兑换与提现"),ogTitle:"UU"+t("竞拍")+" | "+t("无缝代币兑换系统"),description:"UU"+t("竞拍平台提供流畅的代币兑换与提现服务")+"，"+t("轻松将")+"USDT"+t("兑换为")+"UB"+t("筹码")+"，"+t("或将获得的奖励兑换回其他代币")+"。",ogDescription:t("需要筹码参与竞拍")+"？"+t("想要提现您的奖励")+"？UU"+t("竞拍平台提供便捷的代币兑换系统")+"，"+t("支持")+"USDT"+t("与")+"UB"+t("筹码的即时兑换")+"，"+t("零延迟")+"，"+t("低手续费")+"。"+t("一键")+"Max"+t("功能让您轻松管理资产")+"，"+t("立即体验区块链资产的灵活流动性")+"！"});const{address:x}=oe(),u=Fe(),n=v(Y("USDT")),r=v(Y("UB")),m=v(!1),l=v(null),k=b(()=>n.value.tokenInfo.symbol==="UB"?String(Number(l.value)*(100-Number(f.value))/100):l.value),f=v(0n),p=b(()=>n.value.tokenInfo.symbol==="UB"?(100-Number(f.value))/100:1),c=async()=>{f.value===0n&&(f.value=await u.swapFee()),n.value.allowanceMap[u.address.value]||await n.value.allowance(u.address.value)},_=b(()=>!l.value||!n.value?0n:q(l.value,n.value.tokenInfo.decimals)),T=b(()=>({from:J(n.value.balance,n.value.tokenInfo.decimals),to:J(r.value.balance,r.value.tokenInfo.decimals)})),M=b(()=>(n.value.allowanceMap[u.address.value]||0n)>=_.value),Z=()=>{n.value&&(l.value=T.value.from)},A=async s=>{if(n.value.tokenInfo.symbol===s)return;const o=n.value;n.value=r.value,r.value=o,n.value.tokenInfo.symbol==="UB"&&c()},{isPending:N,mutateAsync:ee}=Q({mutationFn:async s=>{if(!s){h("请输入有效金额");return}await n.value.approve(u.address.value,q(s,n.value.tokenInfo.decimals)),await n.value.allowance(u.address.value)}}),{isPending:D,mutate:te}=Q({mutationFn:async()=>{if(!n.value||!r.value||!_.value){h(t(t("请输入有效金额")));return}if(n.value.balance<_.value){h(t("余额不足"));return}if(!M.value){h(t("授权额度不足"));return}const s=BigInt(l.value||0);if(s<10n){h(t("最小交易金额")+"10");return}const o=me({message:t("兑换中")+"...",duration:0});try{await u.swap(n.value.tokenInfo.address,s),o.open({type:"success",message:t("兑换成功"),duration:2e3}),n.value.balanceOf(),r.value.balanceOf(),n.value.allowance(u.address.value),l.value=null}catch(g){o.open({type:"error",message:g.shortMessage||t("兑换失败"),duration:2e3})}}});return ye(x,s=>{s&&(n.value.balanceOf(),n.value.allowance(u.address.value),r.value.balanceOf())},{immediate:!0}),(s,o)=>{var B,S,H,E,$,z,j,O,V;const g=ie,ne=re,R=le,ae=ue;return y(),F("div",he,[U(g,{title:e(t)("兑换")},null,8,["title"]),a("div",ke,[a("div",Te,[a("div",ge,[a("div",Ie,[a("div",{onClick:o[0]||(o[0]=d=>A("USDT")),class:W([e(n).tokenInfo.symbol=="USDT"?"bg-white text-black":"","rounded px-3"])},i(e(t)("兑换")),3),a("div",{onClick:o[1]||(o[1]=d=>A("UB")),class:W([e(n).tokenInfo.symbol=="UB"?"bg-white text-black":"","rounded px-3"])},i(e(t)("提现")),3)]),a("div",Ue,i(e(t)("兑换数量")),1),a("div",Ce,[a("div",Me,[a("div",Ae,[a("img",{src:(B=e(n))==null?void 0:B.tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,Ne),a("div",null,[a("div",null,[a("div",De,i((S=e(n))==null?void 0:S.tokenInfo.symbol),1)]),a("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[2]||(o[2]=P(d=>("copyHandle"in s?s.copyHandle:e(X))(e(n).tokenInfo.address),["stop"]))},i(("addressFl"in s?s.addressFl:e(K))((H=e(n))==null?void 0:H.tokenInfo.address)),1)])]),a("div",Re,[a("div",Be,i(e(t)("余额"))+": "+i(("formatNumber"in s?s.formatNumber:e(C))(e(T).from)),1)])]),a("div",Se,[U(ne,{modelValue:e(l),"onUpdate:modelValue":o[3]||(o[3]=d=>L(l)?l.value=d:null),class:"bg-transparent text-white text-xl w-3/4 outline-none",placeholder:"0.0"},null,8,["modelValue"]),a("button",{onClick:Z,class:"bg-transparent shadow-none h-[22px] text-xs border border-[#D1D1D1] rounded px-2 py-1"},"Max")])])]),a("div",He,[a("div",Ee,i(e(t)("获得数量")),1),a("div",$e,[a("div",ze,[a("div",je,[a("img",{src:e(r).tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,Oe),a("div",null,[a("div",Ve,i((E=e(r))==null?void 0:E.tokenInfo.symbol),1),a("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[4]||(o[4]=P(d=>("copyHandle"in s?s.copyHandle:e(X))(e(r).tokenInfo.address),["stop"]))},i(("addressFl"in s?s.addressFl:e(K))(($=e(r))==null?void 0:$.tokenInfo.address)),1)])]),a("div",We,[a("div",Pe,i(e(t)("余额"))+": "+i(("formatNumber"in s?s.formatNumber:e(C))(e(T).to)),1)])]),a("div",Le,[a("input",{value:("formatNumber"in s?s.formatNumber:e(C))(e(k)||0),type:"text",class:"bg-transparent text-white text-xl w-full outline-none",placeholder:"0.0",readonly:""},null,8,Ge)])])]),a("div",qe,[e(M)?(y(),F("button",{key:1,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[6]||(o[6]=d=>e(te)()),disabled:e(D)||!e(l)||Number(e(l))<=0},[e(D)?(y(),G(R,{key:0,type:"spinner",color:"#000"})):(y(),F("span",Qe,i(e(t)("立即兑换")),1))],8,Ke)):(y(),F("button",{key:0,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[5]||(o[5]=d=>m.value=!0),disabled:e(N)||!e(l)||Number(e(l))<=0},[e(N)?(y(),G(R,{key:0,type:"spinner",color:"#000"})):(y(),F("span",Xe,i(e(t)("授权"))+" "+i((z=e(n))==null?void 0:z.tokenInfo.symbol),1))],8,Je))]),a("div",Ye,i(e(t)("兑换比例"))+": 1 "+i((j=e(n))==null?void 0:j.tokenInfo.symbol)+" = "+i(e(p))+" "+i((O=e(r))==null?void 0:O.tokenInfo.symbol),1)])]),U(ae,{show:e(m),"onUpdate:show":o[7]||(o[7]=d=>L(m)?m.value=d:null),address:(V=e(n))==null?void 0:V.tokenInfo.address,amount:e(l)||0,approve:e(ee)},null,8,["show","address","amount","approve"])])}}}),ut=xe(Ze,[["__scopeId","data-v-1fdb43a1"]]);export{ut as default};
