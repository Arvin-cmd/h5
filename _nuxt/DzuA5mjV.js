import{_ as be,s as ve}from"./Btxg4FkC.js";import{_ as we,a as _e,s as h,c as xe}from"./dFuH5_e5.js";import{d9 as Fe,cB as b,cA as v,da as M,db as he,d2 as ke,d3 as Te,cz as ge,e6 as Ie,cW as k,c_ as C,cY as n,d5 as e,dX as ae,cZ as i,df as se,dY as oe,de as ie,cX as y}from"./BWftuhBA.js";import{o as Ue,p as le,f as re,a as ue,b as N}from"./CFtiEey3.js";import{g as Ae,u as Me,a as Ce,b as de}from"./CcKT-9ls.js";import{u as pe}from"./DUeuwroF.js";import{a as Ne}from"./B2hPhjug.js";import{_ as De}from"./DlAUqK2U.js";const Re=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AccessControlBadConfirmation",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"neededRole",type:"bytes32"}],name:"AccessControlUnauthorizedAccount",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Swap",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"adminWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_usdt",type:"address"},{internalType:"address",name:"_ubToken",type:"address"},{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"callerConfirmation",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"swap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"swapFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ubToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"usdt",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"}],Be=()=>{const w=Fe(),_=Ae("EXCHANGE"),{writeContractAsync:s}=Me({}),{connect:x}=Ce(),r=b(()=>({address:_.value,abi:Re})),t=v(0n);async function u(){return t.value=await he(w,{...r.value,functionName:"swapFee"}),t.value}async function m(d){await x();const c=await s({...r.value,functionName:"setSwapFee",args:[d]});await M(w,{hash:c})}async function l(d,c){const I=await s({...r.value,functionName:"swap",args:[d,c]});await M(w,{hash:I})}async function g(d){await x();const c=await s({...r.value,functionName:"adminWithdraw",args:[d]});await M(w,{hash:c})}return{address:_,fee:t,swapFee:u,setSwapFee:m,swap:l,adminWithdraw:g}},Se={class:"flex flex-col h-screen"},Ee={class:"mx-4 mt-10 border border-[#FFFFFF33] p-5 rounded-xl bg-white/10 backdrop-blur-sm border-bg"},$e={class:"relative"},ze={class:"mb-4"},We={class:"flex gap-4 pb-4"},je={class:"text-[#D1D1D1] text-xs mb-2"},He={class:"bg-[#FFFFFF1A] rounded-lg p-3"},Oe={class:"flex justify-between items-center mb-2"},Ve={class:"flex items-center"},Pe=["src"],Le={class:"text-white font-medium text-xs"},Xe={class:"text-right"},Ge={class:"text-[#FFFFFF80] text-xs"},Ye={class:"flex justify-between items-center"},Ze={class:"mb-4"},qe={class:"text-[#D1D1D1] text-xs mb-2"},Je={class:"bg-[#FFFFFF1A] rounded-lg p-3"},Ke={class:"flex justify-between items-center mb-2"},Qe={class:"flex items-center"},et=["src"],tt={class:"text-white font-medium text-xs"},nt={class:"text-right"},at={class:"text-[#FFFFFF80] text-xs"},st={class:"flex justify-between items-center"},ot=["value"],it={class:"flex justify-center mt-4"},lt=["disabled"],rt={key:1},ut=["disabled"],dt={key:1},pt={class:"text-center mt-3 text-[#FFFFFF80] text-xs"},ct=ke({__name:"index",setup(w){const{openExplorer:_}=Ue(),{t:s}=Te();Ne({title:"UU竞拍 - 快捷代币兑换与提现",ogTitle:"UU竞拍 | 无缝代币兑换系统",description:"UU竞拍平台提供流畅的代币兑换与提现服务，轻松将USDT兑换为UB筹码，或将获得的奖励兑换回其他代币。",ogDescription:"需要筹码参与竞拍？想要提现您的奖励？UU竞拍平台提供便捷的代币兑换系统，支持USDT与UB筹码的即时兑换，零延迟，低手续费。一键Max功能让您轻松管理资产，立即体验区块链资产的灵活流动性！"});const{address:x}=ge(),r=Be(),t=v(pe("USDT")),u=v(pe("UB")),m=v(!1),l=v(null),g=b(()=>{var a;return((a=t.value.tokenInfo)==null?void 0:a.symbol)==="UB"?String(Number(l.value)*(100-Number(d.value))/100):l.value}),d=v(0n),c=b(()=>{var a;return((a=t.value.tokenInfo)==null?void 0:a.symbol)==="UB"?(100-Number(d.value))/100:1}),I=async()=>{x.value&&(d.value===0n&&(d.value=await r.swapFee()),t.value.allowanceMap[r.address.value]||await t.value.allowance(r.address.value))},U=b(()=>!l.value||!t.value?0n:le(l.value,t.value.tokenInfo.decimals)),A=b(()=>({from:re(t.value.balance,t.value.tokenInfo.decimals),to:re(u.value.balance,u.value.tokenInfo.decimals)})),D=b(()=>(t.value.allowanceMap[r.address.value]||0n)>=U.value),ce=()=>{t.value&&(l.value=A.value.from)},R=async a=>{var f,T;if(((f=t.value.tokenInfo)==null?void 0:f.symbol)===a)return;const o=t.value;t.value=u.value,u.value=o,((T=t.value.tokenInfo)==null?void 0:T.symbol)==="UB"&&I()},{isPending:B,mutateAsync:ye}=de({mutationFn:async a=>{if(!a){h("请输入有效金额");return}await t.value.approve(r.address.value,le(a,t.value.tokenInfo.decimals)),await t.value.allowance(r.address.value)}}),{isPending:S,mutate:me}=de({mutationFn:async()=>{if(!t.value||!u.value||!U.value){h(s(s("请输入有效金额")));return}if(t.value.balance<U.value){h(s("余额不足"));return}if(!D.value){h(s("授权额度不足"));return}const a=BigInt(l.value||0);if(a<1n){h(s("最小交易金额")+"1");return}const o=xe({message:s("兑换中")+"...",duration:0});try{await r.swap(t.value.tokenInfo.address,a),o.open({type:"success",message:s("兑换成功"),duration:2e3}),t.value.balanceOf(),u.value.balanceOf(),t.value.allowance(r.address.value),l.value=null}catch(f){o.open({type:"error",message:f.shortMessage||s("兑换失败"),duration:2e3})}}});return Ie(x,a=>{a&&(t.value.balanceOf(),t.value.allowance(r.address.value),u.value.balanceOf())},{immediate:!0}),(a,o)=>{var $,z,W,j,H,O,V,P,L,X,G,Y,Z,q,J,K,Q,ee,te,ne;const f=be,T=we,E=ve,fe=_e;return y(),k("div",Se,[C(f,{title:e(s)("兑换")},null,8,["title"]),n("div",Ee,[n("div",$e,[n("div",ze,[n("div",We,[n("div",{onClick:o[0]||(o[0]=p=>R("USDT")),class:ae([(($=e(t).tokenInfo)==null?void 0:$.symbol)=="USDT"?"bg-white text-black":"","rounded px-3"])},i(e(s)("兑换")),3),n("div",{onClick:o[1]||(o[1]=p=>R("UB")),class:ae([((z=e(t).tokenInfo)==null?void 0:z.symbol)=="UB"?"bg-white text-black":"","rounded px-3"])},i(e(s)("提现")),3)]),n("div",je,i(e(s)("兑换数量")),1),n("div",He,[n("div",Oe,[n("div",Ve,[n("img",{src:(j=(W=e(t))==null?void 0:W.tokenInfo)==null?void 0:j.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,Pe),n("div",null,[n("div",null,[n("div",Le,i((O=(H=e(t))==null?void 0:H.tokenInfo)==null?void 0:O.symbol),1)]),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[2]||(o[2]=se(p=>{var F;return e(_)("address",(F=e(t).tokenInfo)==null?void 0:F.address)},["stop"]))},i(("addressFl"in a?a.addressFl:e(ue))((P=(V=e(t))==null?void 0:V.tokenInfo)==null?void 0:P.address)),1)])]),n("div",Xe,[n("div",Ge,i(e(s)("余额"))+": "+i(("formatNumber"in a?a.formatNumber:e(N))(e(A).from)),1)])]),n("div",Ye,[C(T,{modelValue:e(l),"onUpdate:modelValue":o[3]||(o[3]=p=>oe(l)?l.value=p:null),class:"bg-transparent text-white text-xl w-3/4 outline-none",placeholder:"0.0"},null,8,["modelValue"]),n("button",{onClick:ce,class:"bg-transparent text-xs border border-[#D1D1D1] rounded px-2 py-1"},"Max")])])]),n("div",Ze,[n("div",qe,i(e(s)("获得数量")),1),n("div",Je,[n("div",Ke,[n("div",Qe,[n("img",{src:e(u).tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,et),n("div",null,[n("div",tt,i((X=(L=e(u))==null?void 0:L.tokenInfo)==null?void 0:X.symbol),1),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[4]||(o[4]=se(p=>{var F;return e(_)("address",(F=e(u).tokenInfo)==null?void 0:F.address)},["stop"]))},i(("addressFl"in a?a.addressFl:e(ue))((Y=(G=e(u))==null?void 0:G.tokenInfo)==null?void 0:Y.address)),1)])]),n("div",nt,[n("div",at,i(e(s)("余额"))+": "+i(("formatNumber"in a?a.formatNumber:e(N))(e(A).to)),1)])]),n("div",st,[n("input",{value:("formatNumber"in a?a.formatNumber:e(N))(e(g)||0),type:"text",class:"bg-transparent text-white text-xl w-full outline-none",placeholder:"0.0",readonly:""},null,8,ot)])])]),n("div",it,[e(D)?(y(),k("button",{key:1,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[6]||(o[6]=p=>e(me)()),disabled:e(S)||!e(l)||Number(e(l))<=0},[e(S)?(y(),ie(E,{key:0,type:"spinner",color:"#000"})):(y(),k("span",dt,i(e(s)("立即兑换")),1))],8,ut)):(y(),k("button",{key:0,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[5]||(o[5]=p=>m.value=!0),disabled:e(B)||!e(l)||Number(e(l))<=0},[e(B)?(y(),ie(E,{key:0,type:"spinner",color:"#000"})):(y(),k("span",rt,i(e(s)("授权"))+" "+i((q=(Z=e(t))==null?void 0:Z.tokenInfo)==null?void 0:q.symbol),1))],8,lt))]),n("div",pt,i(e(s)("兑换比例"))+": 1 "+i((K=(J=e(t))==null?void 0:J.tokenInfo)==null?void 0:K.symbol)+" = "+i(e(c))+" "+i((ee=(Q=e(u))==null?void 0:Q.tokenInfo)==null?void 0:ee.symbol),1)])]),C(fe,{show:e(m),"onUpdate:show":o[7]||(o[7]=p=>oe(m)?m.value=p:null),address:(ne=(te=e(t))==null?void 0:te.tokenInfo)==null?void 0:ne.address,amount:e(l)||0,approve:e(ye)},null,8,["show","address","amount","approve"])])}}}),Ft=De(ct,[["__scopeId","data-v-8278db21"]]);export{Ft as default};
