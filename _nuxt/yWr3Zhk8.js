import{_ as xe,s as _e}from"./Ct7Ffzkv.js";import{_ as we,a as he,s as k,d as ke}from"./DCXi3YRt.js";import{af as Fe,s as w,ag as M,ah as Te,e as ge,u as Ie,q as Ue,x as F,J as oe,y as ie,R as Ce,c as T,b as D,a as n,z as e,C as le,t as o,A as re,E as ue,D as de,o as f}from"./du6FXzWk.js";import{o as Ae,a as pe,f as R}from"./CijhgYeQ.js";import{g as Me,b as De,d as Re,e as N,u as ce}from"./Cy-h5_cU.js";import{u as ye}from"./Cb3vITa0.js";import{a as Ne}from"./D1nuaBJH.js";import{_ as Se}from"./DlAUqK2U.js";import"./s7WYq-nx.js";const I=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AccessControlBadConfirmation",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"neededRole",type:"bytes32"}],name:"AccessControlUnauthorizedAccount",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Swap",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"adminWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_usdt",type:"address"},{internalType:"address",name:"_ubToken",type:"address"},{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"callerConfirmation",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"swap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"swapFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ubToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"usdt",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"}],Be=()=>{const c=Fe(),y=Me("EXCHANGE"),{writeContractAsync:a}=De({}),{connect:v}=Re(),u=w(0n);async function t(){return u.value=await Te(c,{address:y.value,abi:I,functionName:"swapFee"}),u.value}async function r(b){await v();const d={address:y.value,abi:I,functionName:"setSwapFee",args:[b]};await N(c,d);const m=await a(d);await M(c,{hash:m})}async function x(b,d){await v();const m={address:y.value,abi:I,functionName:"swap",args:[b,d]};await N(c,m);const U=await a(m);await M(c,{hash:U})}async function i(b){await v();const d={address:y.value,abi:I,functionName:"adminWithdraw",args:[b]};await N(c,d);const m=await a(d);await M(c,{hash:m})}return{address:y,fee:u,swapFee:t,setSwapFee:r,swap:x,adminWithdraw:i}},Ee={class:"flex flex-col h-screen"},$e={class:"mx-4 mt-10 border border-[#FFFFFF33] p-5 rounded-xl bg-white/10 backdrop-blur-sm border-bg"},ze={class:"relative"},je={class:"mb-4"},He={class:"flex gap-4 pb-4"},Oe={class:"text-[#D1D1D1] text-xs mb-2"},Ve={class:"bg-[#FFFFFF1A] rounded-lg p-3"},We={class:"flex justify-between items-center mb-2"},Pe={class:"flex items-center"},Le=["src"],Ge={class:"text-white font-medium text-xs"},qe={class:"text-right"},Je={class:"text-[#FFFFFF80] text-xs"},Xe={class:"flex justify-between items-center"},Ke={class:"mb-4"},Qe={class:"text-[#D1D1D1] text-xs mb-2"},Ye={class:"bg-[#FFFFFF1A] rounded-lg p-3"},Ze={class:"flex justify-between items-center mb-2"},et={class:"flex items-center"},tt=["src"],nt={class:"text-white font-medium text-xs"},at={class:"text-right"},st={class:"text-[#FFFFFF80] text-xs"},ot={class:"flex justify-between items-center"},it=["value"],lt={class:"flex justify-center mt-4"},rt=["disabled"],ut={key:1},dt=["disabled"],pt={key:1},ct={class:"text-center mt-3 text-[#FFFFFF80] text-xs"},yt=ge({__name:"index",setup(c){const{openExplorer:y}=Ae(),{t:a}=Ie();Ne({title:"UU竞拍 - 快捷代币兑换与提现",ogTitle:"UU竞拍 | 无缝代币兑换系统",description:"UU竞拍平台提供流畅的代币兑换与提现服务，轻松将USDT兑换为UB筹码，或将获得的奖励兑换回其他代币。",ogDescription:"需要筹码参与竞拍？想要提现您的奖励？UU竞拍平台提供便捷的代币兑换系统，支持USDT与UB筹码的即时兑换，零延迟，低手续费。一键Max功能让您轻松管理资产，立即体验区块链资产的灵活流动性！"});const{address:v}=Ue(),u=Be(),t=w(ye("USDT")),r=w(ye("UB")),x=w(!1),i=w(null),b=F(()=>{var l;return((l=t.value.tokenInfo)==null?void 0:l.symbol)==="UB"?String(Number(i.value)*(100-Number(d.value))/100):i.value}),d=w(0n),m=F(()=>{var l;return((l=t.value.tokenInfo)==null?void 0:l.symbol)==="UB"?(100-Number(d.value))/100:1}),U=async()=>{v.value&&(d.value===0n&&(d.value=await u.swapFee()),t.value.allowanceMap[u.address.value]||await t.value.allowance(u.address.value))},C=F(()=>!i.value||!t.value?0n:oe(i.value.toString(),t.value.tokenInfo.decimals)),A=F(()=>({from:Number(ie(t.value.balance,t.value.tokenInfo.decimals)),to:Number(ie(r.value.balance,r.value.tokenInfo.decimals))})),S=F(()=>(t.value.allowanceMap[u.address.value]||0n)>=C.value),me=()=>{t.value&&(i.value=~~A.value.from)},B=async l=>{var _,g;if(((_=t.value.tokenInfo)==null?void 0:_.symbol)===l)return;const s=t.value;t.value=r.value,r.value=s,((g=t.value.tokenInfo)==null?void 0:g.symbol)==="UB"&&U()},{isPending:E,mutateAsync:be}=ce({mutationFn:async l=>{if(!l){k("请输入有效金额");return}await t.value.approve(u.address.value,oe(l.toString(),t.value.tokenInfo.decimals)),await t.value.allowance(u.address.value)}}),{isPending:$,mutate:fe}=ce({mutationFn:async()=>{if(!t.value||!r.value||!C.value){k(a(a("请输入有效金额")));return}if(t.value.balance<C.value){k(a("余额不足"));return}if(!S.value){k(a("授权额度不足"));return}const l=BigInt(i.value||0);if(l<1n){k(a("最小交易金额")+"1");return}const s=ke({message:a("兑换中")+"...",duration:0});try{await u.swap(t.value.tokenInfo.address,l),s.open({type:"success",message:a("兑换成功"),duration:2e3}),t.value.balanceOf(),r.value.balanceOf(),t.value.allowance(u.address.value),i.value=null}catch(_){s.open({type:"error",message:_.shortMessage||a("兑换失败"),duration:2e3})}}});return Ce(v,l=>{l&&(t.value.balanceOf(),t.value.allowance(u.address.value),r.value.balanceOf())},{immediate:!0}),(l,s)=>{var j,H,O,V,W,P,L,G,q,J,X,K,Q,Y,Z,ee,te,ne,ae,se;const _=xe,g=we,z=_e,ve=he;return f(),T("div",Ee,[D(_,{title:e(a)("兑换")},null,8,["title"]),n("div",$e,[n("div",ze,[n("div",je,[n("div",He,[n("div",{onClick:s[0]||(s[0]=p=>B("USDT")),class:le([((j=e(t).tokenInfo)==null?void 0:j.symbol)=="USDT"?"bg-white text-black":"","rounded px-3"])},o(e(a)("兑换")),3),n("div",{onClick:s[1]||(s[1]=p=>B("UB")),class:le([((H=e(t).tokenInfo)==null?void 0:H.symbol)=="UB"?"bg-white text-black":"","rounded px-3"])},o(e(a)("提现")),3)]),n("div",Oe,o(e(a)("兑换数量")),1),n("div",Ve,[n("div",We,[n("div",Pe,[n("img",{src:(V=(O=e(t))==null?void 0:O.tokenInfo)==null?void 0:V.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,Le),n("div",null,[n("div",null,[n("div",Ge,o((P=(W=e(t))==null?void 0:W.tokenInfo)==null?void 0:P.symbol),1)]),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:s[2]||(s[2]=re(p=>{var h;return e(y)("address",(h=e(t).tokenInfo)==null?void 0:h.address)},["stop"]))},o(e(pe)((G=(L=e(t))==null?void 0:L.tokenInfo)==null?void 0:G.address)),1)])]),n("div",qe,[n("div",Je,o(e(a)("余额"))+": "+o(e(R)(e(A).from)),1)])]),n("div",Xe,[D(g,{modelValue:e(i),"onUpdate:modelValue":s[3]||(s[3]=p=>ue(i)?i.value=p:null),class:"bg-transparent text-white text-xl w-3/4 outline-none",placeholder:"0.0"},null,8,["modelValue"]),n("button",{onClick:me,class:"bg-transparent text-xs border border-[#D1D1D1] rounded px-2 py-1"},"Max")])])]),n("div",Ke,[n("div",Qe,o(e(a)("获得数量")),1),n("div",Ye,[n("div",Ze,[n("div",et,[n("img",{src:e(r).tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,tt),n("div",null,[n("div",nt,o((J=(q=e(r))==null?void 0:q.tokenInfo)==null?void 0:J.symbol),1),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:s[4]||(s[4]=re(p=>{var h;return e(y)("address",(h=e(r).tokenInfo)==null?void 0:h.address)},["stop"]))},o(e(pe)((K=(X=e(r))==null?void 0:X.tokenInfo)==null?void 0:K.address)),1)])]),n("div",at,[n("div",st,o(e(a)("余额"))+": "+o(e(R)(e(A).to)),1)])]),n("div",ot,[n("input",{value:e(R)(e(b)||0),type:"text",class:"bg-transparent text-white text-xl w-full outline-none",placeholder:"0.0",readonly:""},null,8,it)])])]),n("div",lt,[e(S)?(f(),T("button",{key:1,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:s[6]||(s[6]=p=>e(fe)()),disabled:e($)||!e(i)||Number(e(i))<=0},[e($)?(f(),de(z,{key:0,type:"spinner",color:"#000"})):(f(),T("span",pt,o(e(a)("立即兑换")),1))],8,dt)):(f(),T("button",{key:0,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:s[5]||(s[5]=p=>x.value=!0),disabled:e(E)||!e(i)||Number(e(i))<=0},[e(E)?(f(),de(z,{key:0,type:"spinner",color:"#000"})):(f(),T("span",ut,o(e(a)("授权"))+" "+o((Y=(Q=e(t))==null?void 0:Q.tokenInfo)==null?void 0:Y.symbol),1))],8,rt))]),n("div",ct,o(e(a)("兑换比例"))+": 1 "+o((ee=(Z=e(t))==null?void 0:Z.tokenInfo)==null?void 0:ee.symbol)+" = "+o(e(m))+" "+o((ne=(te=e(r))==null?void 0:te.tokenInfo)==null?void 0:ne.symbol),1)])]),D(ve,{show:e(x),"onUpdate:show":s[7]||(s[7]=p=>ue(x)?x.value=p:null),address:(se=(ae=e(t))==null?void 0:ae.tokenInfo)==null?void 0:se.address,amount:e(i)||0,approve:e(be)},null,8,["show","address","amount","approve"])])}}}),Ft=Se(yt,[["__scopeId","data-v-c7dcd7e1"]]);export{Ft as default};
