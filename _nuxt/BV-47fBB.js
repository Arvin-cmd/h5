import{_ as se,s as oe}from"./C1sHKuLU.js";import{_ as ie,a as le}from"./BUoiaHVL.js";import{I as re,e as v,r as w,J as I,K as ue,y as de,z as pe,c as ce,aD as ye,n as F,v as U,q as n,B as e,aB as W,s as i,O as P,aC as L,N as G,p as y}from"./BAumNzA0.js";import{p as q,f as J,c as K,a as X,b as C,s as h,d as me}from"./CtEefc1e.js";import{g as fe,u as be,a as ve,b as Q}from"./gYml6LKr.js";import{u as Y}from"./hZ89RS-S.js";import{a as we}from"./BFu5KGiT.js";import{_ as _e}from"./DlAUqK2U.js";import"./C-6VqVVC.js";const xe=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AccessControlBadConfirmation",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"neededRole",type:"bytes32"}],name:"AccessControlUnauthorizedAccount",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Swap",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"adminWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_usdt",type:"address"},{internalType:"address",name:"_ubToken",type:"address"},{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"callerConfirmation",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_swapFee",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"swap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"swapFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ubToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"usdt",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"}],Fe=()=>{const _=re(),s=fe("EXCHANGE"),{writeContractAsync:m}=be({}),{connect:u}=ve(),t=v(()=>({address:s.value,abi:xe})),r=w(0n);async function f(){return r.value=await ue(_,{...t.value,functionName:"swapFee"}),r.value}async function l(p){await u();const c=await m({...t.value,functionName:"setSwapFee",args:[p]});await I(_,{hash:c})}async function k(p,c){const x=await m({...t.value,functionName:"swap",args:[p,c]});await I(_,{hash:x})}async function b(p){await u();const c=await m({...t.value,functionName:"adminWithdraw",args:[p]});await I(_,{hash:c})}return{address:s,fee:r,swapFee:f,setSwapFee:l,swap:k,adminWithdraw:b}},he={class:"flex flex-col h-screen"},ke={class:"mx-4 mt-10 border border-[#FFFFFF33] p-5 rounded-xl bg-white/10 backdrop-blur-sm border-bg"},Te={class:"relative"},ge={class:"mb-4"},Ie={class:"flex gap-4 pb-4"},Ue={class:"text-[#D1D1D1] text-xs mb-2"},Ce={class:"bg-[#FFFFFF1A] rounded-lg p-3"},Me={class:"flex justify-between items-center mb-2"},Ae={class:"flex items-center"},Ne=["src"],De={class:"text-white font-medium text-xs"},Re={class:"text-right"},Be={class:"text-[#FFFFFF80] text-xs"},Se={class:"flex justify-between items-center"},He={class:"mb-4"},Ee={class:"text-[#D1D1D1] text-xs mb-2"},$e={class:"bg-[#FFFFFF1A] rounded-lg p-3"},ze={class:"flex justify-between items-center mb-2"},Oe={class:"flex items-center"},je=["src"],Ve={class:"text-white font-medium text-xs"},We={class:"text-right"},Pe={class:"text-[#FFFFFF80] text-xs"},Le={class:"flex justify-between items-center"},Ge=["value"],qe={class:"flex justify-center mt-4"},Je=["disabled"],Ke={key:1},Xe=["disabled"],Qe={key:1},Ye={class:"text-center mt-3 text-[#FFFFFF80] text-xs"},Ze=de({__name:"index",setup(_){const{t:s}=pe();we({title:"UU竞拍 - 快捷代币兑换与提现",ogTitle:"UU竞拍 | 无缝代币兑换系统",description:"UU竞拍平台提供流畅的代币兑换与提现服务，轻松将USDT兑换为UB筹码，或将获得的奖励兑换回其他代币。",ogDescription:"需要筹码参与竞拍？想要提现您的奖励？UU竞拍平台提供便捷的代币兑换系统，支持USDT与UB筹码的即时兑换，零延迟，低手续费。一键Max功能让您轻松管理资产，立即体验区块链资产的灵活流动性！"});const{address:m}=ce(),u=Fe(),t=w(Y("USDT")),r=w(Y("UB")),f=w(!1),l=w(null),k=v(()=>t.value.tokenInfo.symbol==="UB"?String(Number(l.value)*(100-Number(b.value))/100):l.value),b=w(0n),p=v(()=>t.value.tokenInfo.symbol==="UB"?(100-Number(b.value))/100:1),c=async()=>{m.value&&(b.value===0n&&(b.value=await u.swapFee()),t.value.allowanceMap[u.address.value]||await t.value.allowance(u.address.value))},x=v(()=>!l.value||!t.value?0n:q(l.value,t.value.tokenInfo.decimals)),T=v(()=>({from:J(t.value.balance,t.value.tokenInfo.decimals),to:J(r.value.balance,r.value.tokenInfo.decimals)})),M=v(()=>(t.value.allowanceMap[u.address.value]||0n)>=x.value),Z=()=>{t.value&&(l.value=T.value.from)},A=async a=>{if(t.value.tokenInfo.symbol===a)return;const o=t.value;t.value=r.value,r.value=o,t.value.tokenInfo.symbol==="UB"&&c()},{isPending:N,mutateAsync:ee}=Q({mutationFn:async a=>{if(!a){h("请输入有效金额");return}await t.value.approve(u.address.value,q(a,t.value.tokenInfo.decimals)),await t.value.allowance(u.address.value)}}),{isPending:D,mutate:te}=Q({mutationFn:async()=>{if(!t.value||!r.value||!x.value){h(s(s("请输入有效金额")));return}if(t.value.balance<x.value){h(s("余额不足"));return}if(!M.value){h(s("授权额度不足"));return}const a=BigInt(l.value||0);if(a<10n){h(s("最小交易金额")+"10");return}const o=me({message:s("兑换中")+"...",duration:0});try{await u.swap(t.value.tokenInfo.address,a),o.open({type:"success",message:s("兑换成功"),duration:2e3}),t.value.balanceOf(),r.value.balanceOf(),t.value.allowance(u.address.value),l.value=null}catch(g){o.open({type:"error",message:g.shortMessage||s("兑换失败"),duration:2e3})}}});return ye(m,a=>{a&&(t.value.balanceOf(),t.value.allowance(u.address.value),r.value.balanceOf())},{immediate:!0}),(a,o)=>{var B,S,H,E,$,z,O,j,V;const g=se,ne=ie,R=oe,ae=le;return y(),F("div",he,[U(g,{title:e(s)("兑换")},null,8,["title"]),n("div",ke,[n("div",Te,[n("div",ge,[n("div",Ie,[n("div",{onClick:o[0]||(o[0]=d=>A("USDT")),class:W([e(t).tokenInfo.symbol=="USDT"?"bg-white text-black":"","rounded px-3"])},i(e(s)("兑换")),3),n("div",{onClick:o[1]||(o[1]=d=>A("UB")),class:W([e(t).tokenInfo.symbol=="UB"?"bg-white text-black":"","rounded px-3"])},i(e(s)("提现")),3)]),n("div",Ue,i(e(s)("兑换数量")),1),n("div",Ce,[n("div",Me,[n("div",Ae,[n("img",{src:(B=e(t))==null?void 0:B.tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,Ne),n("div",null,[n("div",null,[n("div",De,i((S=e(t))==null?void 0:S.tokenInfo.symbol),1)]),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[2]||(o[2]=P(d=>("copyHandle"in a?a.copyHandle:e(K))(e(t).tokenInfo.address),["stop"]))},i(("addressFl"in a?a.addressFl:e(X))((H=e(t))==null?void 0:H.tokenInfo.address)),1)])]),n("div",Re,[n("div",Be,i(e(s)("余额"))+": "+i(("formatNumber"in a?a.formatNumber:e(C))(e(T).from)),1)])]),n("div",Se,[U(ne,{modelValue:e(l),"onUpdate:modelValue":o[3]||(o[3]=d=>L(l)?l.value=d:null),class:"bg-transparent text-white text-xl w-3/4 outline-none",placeholder:"0.0"},null,8,["modelValue"]),n("button",{onClick:Z,class:"bg-transparent text-xs border border-[#D1D1D1] rounded px-2 py-1"},"Max")])])]),n("div",He,[n("div",Ee,i(e(s)("获得数量")),1),n("div",$e,[n("div",ze,[n("div",Oe,[n("img",{src:e(r).tokenInfo.icon,alt:"Token",class:"w-8 h-8 mr-2"},null,8,je),n("div",null,[n("div",Ve,i((E=e(r))==null?void 0:E.tokenInfo.symbol),1),n("div",{class:"text-[#FFFFFF80] text-xs underline",onClick:o[4]||(o[4]=P(d=>("copyHandle"in a?a.copyHandle:e(K))(e(r).tokenInfo.address),["stop"]))},i(("addressFl"in a?a.addressFl:e(X))(($=e(r))==null?void 0:$.tokenInfo.address)),1)])]),n("div",We,[n("div",Pe,i(e(s)("余额"))+": "+i(("formatNumber"in a?a.formatNumber:e(C))(e(T).to)),1)])]),n("div",Le,[n("input",{value:("formatNumber"in a?a.formatNumber:e(C))(e(k)||0),type:"text",class:"bg-transparent text-white text-xl w-full outline-none",placeholder:"0.0",readonly:""},null,8,Ge)])])]),n("div",qe,[e(M)?(y(),F("button",{key:1,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[6]||(o[6]=d=>e(te)()),disabled:e(D)||!e(l)||Number(e(l))<=0},[e(D)?(y(),G(R,{key:0,type:"spinner",color:"#000"})):(y(),F("span",Qe,i(e(s)("立即兑换")),1))],8,Xe)):(y(),F("button",{key:0,class:"w-[185px] h-9 bg-white text-black rounded-full font-bold",onClick:o[5]||(o[5]=d=>f.value=!0),disabled:e(N)||!e(l)||Number(e(l))<=0},[e(N)?(y(),G(R,{key:0,type:"spinner",color:"#000"})):(y(),F("span",Ke,i(e(s)("授权"))+" "+i((z=e(t))==null?void 0:z.tokenInfo.symbol),1))],8,Je))]),n("div",Ye,i(e(s)("兑换比例"))+": 1 "+i((O=e(t))==null?void 0:O.tokenInfo.symbol)+" = "+i(e(p))+" "+i((j=e(r))==null?void 0:j.tokenInfo.symbol),1)])]),U(ae,{show:e(f),"onUpdate:show":o[7]||(o[7]=d=>L(f)?f.value=d:null),address:(V=e(t))==null?void 0:V.tokenInfo.address,amount:e(l)||0,approve:e(ee)},null,8,["show","address","amount","approve"])])}}}),ut=_e(Ze,[["__scopeId","data-v-96db5758"]]);export{ut as default};
